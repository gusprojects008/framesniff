# for tests

from . import *
    
def main():
    from .l2.ieee802_11.ieee802_11 import IEEE802_11
    from ..common.filter_engine import apply_filters

    eapol_msg1 = bytes.fromhex('''
00001a002f48000062b2270e00000000
00026c09a000c70000008802ca0006ab
f1d631165c628b80838a5c628b80838a
00000000aaaa03000000888e01030075
02008a001000000000000000015de91b
37c74d1ba0a8919d20c971e890a14da3
b29f979e0ca73323404d9f4366000000
00000000000000000000000000000000
00000000000000000000000000000000
000000000000000000000000000016dd
14000fac0413db5dd8d7b4af25317703
399b3e3016
''')
    eapol_msg2 = bytes.fromhex('''
00001a002f48000045ce270e00000000
00026c09a000df00000088013a015c62
8b80838a06abf1d631165c628b80838a
00000600aaaa03000000888e01030075
02010a00000000000000000001db741d
48ed9b31f27f7c6c654844fb57ef5c69
ca8c57b5843df21f319d106ab3000000
00000000000000000000000000000000
000000000000000000000000002cdadf
ff17d404500929a37d848e7f3a001630
140100000fac040100000fac04010000
0fac028000
''' )

    beacon = bytes.fromhex('''
000038002f4040a0200800a020080000895716950100000010026c09a000c8000000000000000000e91317950000000016001103c800c10180000000ffffffffffff788cb5574dc8788cb5574dc8001eee49df341e0100006400111400024c42010882848b961224486c03010132040c1830600706425220010d1b23021b004605f3c001000005040001000230140100000fac040100000fac040100000fac020000dd310050f204104a000110104400010210470010123456789abcdef01234788cb5574dc8103c0001011049000600372a0001202a01042d1aec1117ffff0000010000000000000000000000000000000000003d16010000000000000000000000000000000000000000004a0e14000a002c01c8001400050019007f080100088000000000dd180050f2020101000003a4000027a4000042435e0062322f00200100dd07000c4303000000dd21000ce780000000bf0cb101c0332aff92042aff9204c0050000002affc303010202418ce29d
''')

    parsed_frame = IEEE802_11.frames_parser(beacon)
    store_filter_result, frame_filter_result = apply_filters("", "body.tagged_parameters", parsed_frame) 
    print(parsed_frame)
    if store_filter_result:
        for k, v in frame_filter_result.items():
            for kk, vv in v.items():
                print(vv)
                print()

if __name__ == "__main__":
    main()
