# for tests

from . import *
    
def main():
    from .l2.ieee802_11.ieee802_11 import IEEE802_11
    from ..common.filter_engine import apply_filters
    from ..common.useful_functions import MacVendorResolver

    eapol_msg1 = bytes.fromhex('''
000038002f4040a0200800a020080000cb0ed4420400000010028509a000ce000000000000000000a4c8d4420000000016001103ce00cd018802ca0006abf1d631165c628b80838a5c628b80838a00000000aaaa03000000888e0103007502008a00100000000000000001ba232a9e373ad6b379851fed7cafa2408658421e47dd792c02d8fd5af7b7605c0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000016dd14000fac0413db5dd8d7b4af25317703399b3e3016129f02c1
''')
    eapol_msg2 = bytes.fromhex('''
000038002f4040a0200800a020080000b633d4420400000010028509a000df0000000000000000008dedd4420000000016001103de00df0188093a015c628b80838a06abf1d631165c628b80838a00000600aaaa03000000888e0103007502010a000000000000000000018920dab43115558da962e33b4a8c88104bac33e9527d1c69b4f07e706fab61ca00000000000000000000000000000000000000000000000000000000000000006e4d1929b2fec0f907aa6f6d882e453b001630140100000fac040100000fac040100000fac028000c51b98f9
''' )

    beacon = bytes.fromhex(''' 
000038002f4040a0200800a020080000895716950100000010026c09a000c8000000000000000000e91317950000000016001103c800c10180000000ffffffffffff788cb5574dc8788cb5574dc8001eee49df341e0100006400111400024c42010882848b961224486c03010132040c1830600706425220010d1b23021b004605f3c001000005040001000230140100000fac040100000fac040100000fac020000dd310050f204104a000110104400010210470010123456789abcdef01234788cb5574dc8103c0001011049000600372a0001202a01042d1aec1117ffff0000010000000000000000000000000000000000003d16010000000000000000000000000000000000000000004a0e14000a002c01c8001400050019007f080100088000000000dd180050f2020101000003a4000027a4000042435e0062322f00200100dd07000c4303000000dd21000ce780000000bf0cb101c0332aff92042aff9204c0050000002affc303010202418ce29d
''') # basic specific vendor WPS

    beacon_wps_is_locked = bytes.fromhex('''
000038002f4040a0200800a0200800003bb8896a0200000010028509a000cc00000000000000000015728a6a0000000016001103cb00cc0180000000ffffffffffff5c628b80838a5c628b80838a30e56821bebc1d0100006400111400054c4f504553010882848b961224486c03010632040c183060230213004605f2000100000706425220010d1e050400010101dd360050f204104a0001101044000102105700010110470010000000000000100000005c628b80838a103c0001031049000600372a0001202a01042d1aee1117ffff0000010000000000000000000000000000000000003d16060706000000000000000000000000000000000000004a0e14000a002c01c8001400050019007f0600000800000030140100000fac040100000fac040100000fac020000dd180050f2020101000003a5000027a4000042435e0062322f000b05050094127add07000c4303000000dd9259ed
    ''')

    probe_response = bytes.fromhex('''
000038002f4040a0200800a02008000066368a6a0200000010028509a000b80000000000000000003ef08a6a0000000016001103b000b80150000000d21c749734f5646e60dbd6dc646e60dbd6dcb0fab46e0c99710000006400311c0006415241554a4f010882848b961224486c0301062a010032040c1830602d1a8e1117ffff0000010000000000000000000000000000000000003d160607060000000000000000000000000000000000000030140100000fac040100000fac040100000fac0200007f0801000800000000000b05010000127add180050f2020101800003a4000027a4000042435e0062322f00230213004605f3c00100044a0e14000a002c01c8001400050019000706425220010d1bdd7d0050f204104a0001101044000102103b00010310470010bc329e001dd811b28601646e60dbd6dc102100035a54451023000c5a58484e20476174655761791024000456312e301042000831323334353637381054000800060050f2040001101100065a544520415010080002238c103c0001011049000600372a000120fed5d928
    ''') # full vendor specific WPS

    LB = bytes.fromhex('''
000038002f4040a0200800a0200800005544c2010000000010026c09a000c60000000000000000004602c3010000000016001103c500c60180000000ffffffffffff788cb5574dc8788cb5574dc840a8995157f4490100006400111400024c42010882848b961224486c03010132040c1830600706425220010d1b23021b004605f3c001000005040001000230140100000fac040100000fac040100000fac020000dd310050f204104a000110104400010210470010123456789abcdef01234788cb5574dc8103c0001011049000600372a0001202a01042d1aec1117ffff0000010000000000000000000000000000000000003d16010000000000000000000000000000000000000000004a0e14000a002c01c8001400050019007f080100088000000000dd180050f2020101000003a4000027a4000042435e0062322f00200100dd07000c4303000000dd21000ce780000000bf0cb101c0332aff92042aff9204c0050000002affc3030102023bd7f0a4
    ''')

    mac_vendor_resolver = MacVendorResolver("./core/common/mac-vendors-export.json")

    parsed_frame = IEEE802_11.frames_parser(eapol_msg1, mac_vendor_resolver)
    store_filter_result, frame_filter_result = apply_filters("", "body", parsed_frame) 
    #print(parsed_frame)
    if store_filter_result:
        print(frame_filter_result)
        #for k, v in frame_filter_result.items():
         #   for kk, vv in v.items():
          #      print(vv)
           #     print()

if __name__ == "__main__":
    main()
